<!DOCTYPE html>
<html lang="cn_ZH">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>学习Linux笔记</title>
  </head>

  <body>
    <h2>常见常用的linux命令</h2>
    <h3>一，文件处理命令</h3>
    <h5>ls -l/-a 目录</h5>
    -a显示所有文件，包含隐藏 <br />
    -l显示详细 <br />
    -d查看目录的属性<br />
    -h人性化大小显示 <br />
    <p>
      -l时前面字母的意义：
      -文件,l软连接,d目录,所有者权限user，所属组权限group，其他者权限other
      r:read=4 w:write=2 x:execute=1
    </p>
    mkdir rmdir cp -r复制目录 -p保留文件属性<br />
    mv rm -r删除目录 -f强制执行 <br />
    touch <br />
    cat -n显示行号 <br />
    tac 反向显示<br />
    more分页显示文件 <br />
    less分页显示，可向上翻页 <br />
    head/tail -数字 显示文件前或后多少行 <br />
    tail -f 动态显示文件末尾内容， 监控日志命令 <br />
    ln -s 创建软连接（快接方式）<br />
    <h3>二，权限管理命令</h3>
    chmod -R 递归修改 修改权限 chown 修改所有者，只有root可改 chgrp
    修改文件所属组，只有root可改 umask 查看新建文件或目录的默认权限
    <h3>三，文件搜索命令</h3>
    find [范围] [选项] [匹配条件] <br />
    -name 文件名查找 <br />
    -iname 不区分大小写 <br />
    -size +-n大于或小于n的文件 <br />
    -user 文件所有者 <br />
    -group 所属组 <br />
    -cmin -5, 5分钟内被修改过属性的文件或目录 <br />
    -amin -5, 5分钟内被访问过的 <br />
    -mmin -5, 5分钟内文件内容被改过 <br />
    find 多条件查找 <br />
    find /etc -name inittab -exec ls -l {}\; <br />
    在/etc下查找inittab文件并执行ls -l命令：-exec 命令 {}\; 固定格式 <br />
    -type文件类型 -f 文件 -d目录 -l链接 <br />
    -inum 根据i节点查找 <br />
    locate<br />
    速度非常快，需要locate命令包，在updatedb中查找 tmp中的文件无法查找<br />
    -i不区分大小写选项 <br />
    which 搜索命令所在目录及别名信息，绝对路径 <br />
    whereis 搜索命令所在目录及帮助文档路径 <br />
    grep -iv 指定字符串 文件，在文件中查找字符串匹配的行并输出<br />
    <h3>四，帮助命令</h3>
    man 命令 <br />
    命令 --help 简要显示帮助文档 <br />
    help 命令，显示shell内置命令 <br />
    whatis 命令<br />
    apropos 配置文件 的帮助<br />
    <h3>五，用户管理命令</h3>
    useradd <br />
    passwd <br />
    who/w <br />
    tty本地用户 pts远程用户 uptime服务器运行时间<br />
    <h3>六，压缩解压命令</h3>
    .gz gzip gunzip <br />
    .tar.gz tar [选项] [打包压缩后的文件名] [目录] 打包目录<br />
    -c打包 -v显示详细 -f指定文件名 -z打包时压缩 -x解包 <br />
    .zip zip unzip <br />
    .bz2 bzip2 大压缩比 与tar配合生成.tar.bz2 <br />
    bunzip2解压<br />
    <h3>七，网络命令</h3>
    write 用户名 ctrl+D保存发送 <br />
    wall给所有在线用户发信 用于广播 <br />
    ping <br />
    ifconfig<br />
    mail 用户名，给用户发邮件 <br />
    last 查看最近用户登录信息及重启信息 <br />
    lastlog用户最后一次登录的信息 <br />
    lastlog -u 用户uid 查看该用户 <br />
    traceroute 目标ip网站追踪节点访问路径 <br />
    netstat -t TCP协议 -U upp协议 -l 监听 -r 路由 -n显示ip地址和端口号 <br />
    例：netstat -tlun 查看本机监听端口 <br />
    -an查看本机所有网络端口 <br />
    -rn 查看本机路由表 <br />
    setup （redhat专用）简易界面配置<br />
    service network restart重启网络工具 <br />
    mount 挂载 <br />
    umount 卸载<br />
    <h3>八，关机重启命令</h3>
    shutdown -r重启 now现在或指定时间 <br />
    -h halt关机 <br />
    -c 取消前一个关机命令<br />
    runlevel查询系统运行级别inittab文件<br />
    init ：<br />
    0-关机 1-单用户<br />
    2-不完全单用户，不含NFC服务，网络文件系统 <br />
    3-完全多用户 <br />
    4-未分配 <br />
    5-图形界面<br />
    6-重启 logout退出登录<br />
    <h3>九，rpm包命令</h3>
    <h3>十，文件系统命令</h3>
    df磁盘信息 <br />
    du fsck不用，系统自动运行 <br />
    dumpe2fs 显示快大小数量<br />
    <h4>文件手工分区命令</h4>
    fdisk -l 查看个盘 <br />
    fdisk /dev/sdb（新硬盘名称）<br />
    <h4>进行对新盘分区:</h4>
    partprobe 分区后保存时强制执行，强制读分区表<br />
    格式化 mkfs -t ext4 目标分区 <br />
    建立挂载点 自动挂载配置文件：/etc/fstab 重要系统文件<br />
    修改后需立即执行mount -a自动挂载，不报错才可以 <br />
    mount -o remount, rw /目录, 重挂载修改权限 dump备份命令 <br />

    <h2>Linux 系统备份与还原</h2>
    <h3>1，需要备份的数据 目录</h3>
    /root/ <br />
    /home/ <br />
    /var/spool/mail <br />
    /etc/<br />
    其他目录--有特殊作用的 <br />
    <h3>2，安装服务的数据</h3>
    *apache需要备份的数据 配置文件<br />
    网页主目录 日志文件 *mysql <br />
    源码包安装的mysql:usr/local/mysql/data/<br />
    rpm包安装的mysql:var/lib/mysql/ <br />
    <h3>3，备份策略</h3>
    1，完全备份 <br />
    2，增量备份--只增加备份新增数据，与此前备份一直累计，恢复比较麻烦 <br />
    3，差异备份--备份与第一次的差异数据，与第一次备份累计，使用比较少 <br />
    4，备份与恢复命令 dump与restore dump [选项] 备份之后的文件名 源文件或目录
    <br />
    -level:0-9 -f制定文件名 <br />
    备份文件或目录只能用0级别，备份分区可以用增量备份，1-9级别 <br />
    restore[模式选项][选项] -C：比较备份数据与实际数据的变化 <br />
    -i：进入交互模式，手工选择需要恢复的文件 <br />
    -t：查看模式，用于查看备份文件中拥有哪些数据 -r：还原模式，用于数据还原
    <br />
    选项： -f 指定备份文件的文件名 注：增量备份的恢复应层层恢复

    <h2>Linux服务管理</h2>
    分类： <br />
    rpm包安装的服务： <br />
    独立的服务:<br />
    /etc/init.d启动脚本<br />
    xinetd管理的服务/etc/xinetd.d启动脚本 <br />
    源码包安装的服务 /usr/local/下对应的<br />
    1，chkconfig --list 查看服务自启动状态rpm包安装的服务<br />
    2，源码包安装的服务：一般是/usr/local/下 <br />
    3，独立服务的启动 <br />
    1，路径—命令<br />
    start/stop/status/restart <br />
    2，service 服务 start/stop/status/restart,只用于redhat系统 <br />
    3，查询service status -all <br />
    4，独立服务的自启动管理<br />
    chkconfig [--level运行级别][独立服务名][on/off]<br />
    修改/etc/rc.d/rc.local文件---推荐使用此方法 使用ntsysv命令管理自启动<br />
    5，基于xinetd的服务，超级守护进程
    在现在系统中该服务用的越来越少，启动和自启动是通的，启动一个服务时，会变成自启动
    <br />

    <h3>进程管理目的</h3>
    判断服务器健康状态 <br />
    查看系统中所有进程 <br />
    杀死进程，应先尝试正常关闭进程 <br />
    1，ps<br />
    aux 使用BSD格式显示所有进程 -le 使用linux标准格式显示所有进程 <br />
    2，top<br />
    查看健康状态 <br />
    3，pstree查看进程树 <br />
    4，终止进程命令 kill -l 显示可用信号<br />
    常用信号-1重启进程，-9强制关闭，-15 <br />
    kill pid 终止对应pid的进程 <br />
    killall [选项][信号]进程名，按进程名关闭进程 <br />
    pkill [信号] -t 终端号，按照终端号踢掉用户 <br />

    <h3>工作管理</h3>
    2，查看后台的工作 <br />
    jobs -l,查看放入后台的命令 <br />
    3，将后台暂停的工作恢复到前台执行 fg %工作号<br />
    把后台暂停的工作恢复到后台运行 bg%工作号，<br />
    在后台恢复的命令必须用于可在后台执行的命令 <br />

    <h3>系统资源查看命令</h3>
    1，vmstat简洁显示内存和cpu占用情况<br />
    2，dmesg开机时内核启动信息，配合grep命令查看对应的信息<br />
    3，free[选项],查看内存使用状态<br />
    4，缓存cache是用来加速数据从硬盘中读取的，缓冲buffer是用来加速数据写入硬>盘的速度，都是内存<br />
    5，查看cpu信息，/proc/cpuinfo 6，uname查看系统内核信息版本<br />
    7，判断当前系统的位数：file /bin/ls，借用外部命令<br />
    8，查看当前linux系统发型版本lsb_release -a 9，列出进程占用的文件lsof -p
    pid<br />

    <h3>系统定时任务</h3>
    1，crond <br />
    2，crontab -e 编辑定时任务 -l删除所有 <br />
    固定格式：* * * * * command-绝对地址 <br />

    <h3>日志管理</h3>
    <h4>日志管理服务：rsyslogd服务</h4>
    常见日志 var/log/<br />
    cron记录了定时记录 <br />
    cups记录了打印信息的日志<br />
    dmesg记录了系统开机时内核自检的信息<br />
    btmp记录了错误登录的日志，该文件为二进制文件，需使用lastb命令查看<br />
    lastlog记录系统中所有用户最后一次登录时间的日志，直接使用lastlog查看<br />
    mailog记录邮件信息 <br />
    message记录系统重要信息 <br />
    secure记录验证和授权方面的信息<br />
    wtmp通过last命令查看，记录账户登录注销信息，重新启动时间<br />
    utmp记录当前登录的用户信息，使用w,who,users等命令查看 <br />

    <h4>日志文件格式</h4>
    日志产生的时间+产生的主机+产生日志的服务+产生的日志信息
    日志配置文件：/etc/rsyslog.conf 日志记录位置 日志文件的绝对路径 系统设备文件
    转发给远程主机 用户名 忽略或丢弃的日志
    <h4>日志轮替：切割和轮换</h4>
    日志文件的命名规则：配置文件中加入dateext参数，则日志会用日期来作为日志文件的后缀<br />
    日志规则的配置文件：/etc/logrotate.conf

    <h3>启动管理</h3>
    1，运行级别 <br />
    2，系统启动过程<br />
    <p>
      BIOS-加载-MDR-加载MDR中启动引导程序 单系统直接启动-加载内核-
      多系统调用选择-加载选择的系统的内核-
      内核解压并自检-搜索找到initranfs-建立仿真根目录-加载驱动-挂在真正系统根目录-调用/sbin/init-调用/etc/init/rcS.conf-调用-
      /etc/rc.d/rc.sysinit-系统初始化
    </p>
    <p>/etc/inittab-传入运行级别-/etc/init/rc.conf-调用-/etc/rc.d/rc-</p>
    <p>
      按照运行级别调用-etc/rc[0-6].d-按照优先级启动和关闭相应脚本-启动和关闭-/etc/rc.d/rc.local中程序-登录界面-输入用户名和密码-进入系统
    </p>
    <h4>grub配置文件</h4>
    grub中分区名的表示hd(0,1)
    <h4>系统修复模式</h4>
    1，单用户模式<br />
    进入单用户模式，修改遗忘root密码 修改系统默认运行级别 <br />
    2，光盘修复模式<br />
    进入安全模式后，开启bash 使用chroot
    /mnt/sysimage改变成硬盘根目录后进行操作<br />

    <h1>shell编程基础</h1>
    <h2>输入输出重定向</h2>
    >覆盖 <br />
    >>追加 <br />
    多命令顺序执行 ;顺序执行<br />
    &&顺序逻辑与，前序命令正确执行则继续执行后续命令<br />
    ||顺序逻辑或，前序命令正确执行，后续不再执行，前序命令错误，则执行后续命令<br />
    例：命令 && echo yes || echo no 判断一个命令是否正确执行 <br />
    dd if=输入文件<br />
    of=输出文件 <br />
    bs=字节数（一次输入输出多少个字节数） <br />
    count=数据块个数 <br />
    例：date; dd ；date 统计执行耗时 <br />

    <h2>管道符|</h2>
    命令1 | 命令2<br />
    意思：命令1的正确输出作为命令2的操作对象 命令1必须有正确输出 <br />

    <h2>常见的通配符</h2>
    ?匹配任意一个字符<br />
    *匹配0个或任意多个字符 <br />
    []匹配中括号中任意一个字符<br />
    [-]代表中括号中的一个范围 <br />
    <h2>Bash中其他特殊字符</h2>
    ‘’单引号中的特殊符号没有特殊含义，只是个符号 <br />
    “”双引号中的特殊符号有特殊意义<br />
    ``反引号与$(命令)一样，引用系统命令 <br />
    #在shell脚本中代表注释<br />
    $在调用变量后调用变量的值<br />
    \转义符，把特殊符号的特殊意义注释掉，让其当做普通字符 <br />

    <h2>正则表达式</h2>
    匹配符-注意命令匹配符与正则表达式匹配符的区别 <br />
    grep 命令 <br />
    cut 命令，提取字符<br />
    printf 格式化输出 <br />
    awk 截取符合条件的字符列 <br />
    awk '条件1{动作1}条件2{动作2}条件3{ 动作3}'~ 文件名 <br />
    awk 配合printf加入BEGIN{}在开始执行之前就进行动作<br />
    加入END{}所有动作结束之后执行END动作 <br />

    <h3>sed</h3>
    轻量级流编辑器，用来将数据进行选取、新增、删除、替换的命令 <br />
    sed [选项]'[动作]' 文件名 <br />
    -n 把经过命令处理的行输出到屏幕<br />
    -e允许对输入数据进行多条sed命令编辑<br />
    -i用sed的修改结果直接修改读取数据的文件，而不是由屏幕输出<br />
    不用-i选项，对目标文件不会更改 <br />
    动作：<br />
    a \:追加 ， \当前行连接下一行 <br />
    i \:插入<br />
    c \:行替换 <br />
    d :删除 <br />
    p :输出到屏幕 <br />
    s :字符替换'' <br />
    <br />
    sort排序文件内容命令<br />
    wc统计文件内容命令 判断语句（其他-b -c -L -p -s -S) <br />
    -d判断文件是否存在，并且判断是否为目录<br />
    -e 判断文件是否存在 <br />
    -f判断文件是否存在，并且是否未普通文件<br />
    test 命令 <br />
    test -e 文件名 或 [ -e 文件名 ] 注意两边空格<br />
    判断文件权限--首先判断是否存在，再判断文件类型或权限，注意：有一个有权限就为真<br />
    -r -w -x <br />
    判断两个文件之间的关系 <br />
    文件1 -nt 文件2, 判断文件1的修改时间是否比文件2新， <br />
    文件1 -ot 文件2, 判断文件1的修改时间是否比文件2旧 <br />
    文件1 -ef 文件2,
    判断文件1和文件2的inode号是否一致，即判断这两文文件是否为同一个文件，或者存在硬链接<br />
    两个整数之间比较 -eq -ne -gt -lt -ge -le<br />
    字符串之间的判断---判断变量里是否有值<br />
    -z 字符串， 判断字符串是否为空 <br />
    -n 字符串，判断字符串是否为非空 <br />
    字串1 == 字串2，判断变量的值是否相等 <br />
    字串1 != 字串2 多重条件判断 <br />
    判断1 -a 判断2 逻辑与 <br />
    判断1 -o 判断2 逻辑或 <br />
    !判断1 逻辑非<br />
    <br />
    <h3>if语句：</h3>
    中括号前后空格，与test一致，其实就是test语句 <br />
    单分支 <br />
    if [ 条件判断式]; <br />
    then <br />
    程序 <br />
    fi <br />
    if [ 条件判断式 ] <br />
    then <br />
    程序 <br />
    fi <br />
    多分支 <br />
    if [ 条件 1 ] <br />
    then<br />
    命令1 <br />
    else <br />
    命令2 <br />
    fi <br />
    多分支 <br />
    if then elif then exit 数字----定义返回值 <br />
    elif<br />
    then else fi <br />
    <br />
    标称shell语言(不是注释)： #!/bin/bash<br />
    <br />

    多分支if语句的使用：判断分区使用率 <br />
    多分支if语句使用：备份mysql数据库<br />
    判断apache服务是否启动 <br />
    port=$(nmap -sT 服务器ip | grep tcp | grep http | awk '{print $2}')
    配合定时执行命令，定期备份或检测 <br />
    case $变量名 in "值1" 命令 ;; "值2" 命令 ;; <br />
    esac 用于打印输出列表 <br />
    <h3>for循环</h3>
    语法1：不知道循环次数 <br />
    for 变量 in 值1 值2 值3 ... do 程序 done <br />
    例：<br />
    #!/bin/bash cd /lamp ls *.tar.gz>ls.log<br />
    for i in $(cat ls.log) <br />
    do tar -zxf $i &>/dev/null <br />
    done <br />
    rm -rf /lamp/ls.log<br />
    语法2：知道循环次数 <br />
    for((初始值;循环控制条件;变量变化)) <br />
    do 程序 <br />
    done <br />
    例：<br />
    #!/bin/bash s=0 for((i=1;i<=100;i=i+1)) <br />
    do s=$(($s+$i)) <br />
    done echo "The sum of 1+2+3+...+100 is $s." <br />

    <h3>wihle循环与until循环</h3>
    语法：条件成立，进入循环 <br />
    while[ 条件判断式 ] do 程序 done<br />
    until循环语法,与while循环正相反，条件不成立则进循环 <br />
    语法： <br />
    until [条件判断式 ] do 程序 done<br />
  </body>
</html>

